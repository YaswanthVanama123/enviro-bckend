\documentclass[10pt]{article}

\usepackage[top=1cm,bottom=1cm,left=1cm,right=1cm]{geometry}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{helvet}
\usepackage{tabularx}
\usepackage{array}
\usepackage{longtable}

\renewcommand{\familydefault}{\sfdefault}

% ---- Colors ----
\definecolor{emred}{RGB}{228,0,43}
\definecolor{linegray}{RGB}{190,190,190} % light gray for blanks
\definecolor{totalcolor}{RGB}{120,120,120} % dark gray for totals

\pagestyle{empty}

% ====== GENERIC BLANK HELPERS =====================================

% full-width underline with text centered on the line (used in header + notes)
\newcommand{\filledline}[1]{%
  \leavevmode
  \makebox[\linewidth][c]{%
    \makebox[0pt][c]{\textcolor{linegray}{\rule{\linewidth}{0.25pt}}}%
    \makebox[0pt][c]{\strut #1}%
  }%
}

% medium underline with text centered on the line (generic inline field)
\newcommand{\smallfilled}[1]{%
  \leavevmode
  \makebox[2.0cm][c]{%
    \makebox[0pt][c]{\textcolor{linegray}{\rule{2.0cm}{0.25pt}}}%
    \makebox[0pt][c]{\strut #1}%
  }%
}

% short blank for calc fields – wider width with normal font size to match other fields
\newcommand{\smallfilledshort}[1]{%
  \leavevmode
  \makebox[1.5cm][c]{%
    \makebox[0pt][c]{\textcolor{linegray}{\rule{1.5cm}{0.25pt}}}%
    \makebox[0pt][c]{\strut\small #1}%
  }%
}

% small inline blank for things like "Dumpster $ _____"
\newcommand{\sblank}{\underline{\hspace{1.7cm}}}

% Flex column that wraps text (for tabularx)
\newcolumntype{Y}{>{\raggedright\arraybackslash}X}

% Multi-line header column with automatic height adjustment
\newcolumntype{Z}{>{\raggedright\arraybackslash\small}p}

% ====== SERVICES HELPER MACROS ====================================

% fixed label width inside each SERVICES column
\newlength{\serviceLabelWidth}
% use one of the longer labels to size this area
\settowidth{\serviceLabelWidth}{\scriptsize Foaming Drain Charge \$}

% tiny gap between label and value area (prevents overlap)
\newlength{\serviceGap}
\setlength{\serviceGap}{0.2em}

\newcommand{\serviceSection}[1]{%
  {\bfseries\normalsize\textcolor{emred}{#1}\par}%
  \vspace{0.7em}%
}

% Normal label + aligned blank (appropriate width) – value centered on the line
\newcommand{\serviceLine}[2]{%
  \noindent\normalsize
  % label
  \makebox[\serviceLabelWidth][l]{#1}%
  % small gap after label
  \hspace{\serviceGap}%
  \leavevmode
  % Calculate appropriate width based on content, max 4cm
  \setbox0=\hbox{\strut #2}%
  \ifdim\wd0>4cm%
    \def\fieldwidth{4cm}%
  \else%
    \ifdim\wd0<1.5cm%
      \def\fieldwidth{1.5cm}%
    \else%
      \def\fieldwidth{\dimexpr\wd0+0.5cm\relax}%
    \fi%
  \fi%
  % Create container with calculated width
  \makebox[\fieldwidth][c]{%
    % gray line positioned at zero width
    \makebox[0pt][c]{\textcolor{linegray}{\rule{\fieldwidth}{0.25pt}}}%
    % value text centered on top of that line
    \makebox[0pt][c]{\strut #2}%
  }%
  \par
  \vspace{0.5em}%
}

% Red bold label + aligned blank (appropriate width) – value centered on the line
\newcommand{\serviceBoldLine}[2]{%
  \noindent\normalsize
  % label (bold + red)
  \makebox[\serviceLabelWidth][l]{%
    \textbf{\textcolor{emred}{#1}}%
  }%
  % small gap after label
  \hspace{\serviceGap}%
  \leavevmode
  % Calculate appropriate width based on content, max 4cm
  \setbox0=\hbox{\strut #2}%
  \ifdim\wd0>4cm%
    \def\fieldwidth{4cm}%
  \else%
    \ifdim\wd0<1.5cm%
      \def\fieldwidth{1.5cm}%
    \else%
      \def\fieldwidth{\dimexpr\wd0+0.5cm\relax}%
    \fi%
  \fi%
  % Create container with calculated width
  \makebox[\fieldwidth][c]{%
    % gray line positioned at zero width
    \makebox[0pt][c]{\textcolor{linegray}{\rule{\fieldwidth}{0.25pt}}}%
    % value text centered on top of that line
    \makebox[0pt][c]{\strut #2}%
  }%
  \par
  \vspace{0.5em}%
}

% Dark gray bold label for totals – different color to distinguish from headers
\newcommand{\serviceTotalLine}[2]{%
  \noindent\normalsize
  % label (bold + dark gray)
  \makebox[\serviceLabelWidth][l]{%
    \textbf{\textcolor{totalcolor}{#1}}%
  }%
  % small gap after label
  \hspace{\serviceGap}%
  \leavevmode
  % Calculate appropriate width based on content, max 4cm
  \setbox0=\hbox{\strut #2}%
  \ifdim\wd0>4cm%
    \def\fieldwidth{4cm}%
  \else%
    \ifdim\wd0<1.5cm%
      \def\fieldwidth{1.5cm}%
    \else%
      \def\fieldwidth{\dimexpr\wd0+0.5cm\relax}%
    \fi%
  \fi%
  % Create container with calculated width
  \makebox[\fieldwidth][c]{%
    % gray line positioned at zero width
    \makebox[0pt][c]{\textcolor{linegray}{\rule{\fieldwidth}{0.25pt}}}%
    % value text centered on top of that line
    \makebox[0pt][c]{\strut #2}%
  }%
  \par
  \vspace{0.5em}%
}

% MICROMAX / RPM / SANIPOD: label ____@____=$__
% Bigger font size and better spacing for improved readability
\newcommand{\serviceAtCharge}[4]{%
  \noindent\normalsize
  \mbox{#1}%
  \hspace{0.2em}%
  \smallfilledshort{#2}\hspace{0.15em}@\hspace{0.15em}\smallfilledshort{#3}\hspace{0.15em}=\hspace{0.15em}\$\smallfilledshort{#4}\par
  \vspace{0.5em}%
}

% Big red left-aligned heading (REFRESH POWER SCRUB / SERVICE NOTES)
\newcommand{\serviceBigHeading}[1]{%
  \noindent{\bfseries\normalsize\textcolor{emred}{#1}\par}%
  \vspace{0.3em}%
}

% ====== AGREEMENT + SIGNATURE HELPERS =============================

% short blanks in agreement paragraph (with optional value)
\newcommand{\agreementBlank}[2][2.5cm]{%
  \underline{\makebox[#1][c]{#2}}%
}

% signature-line blanks (no values)
\newcommand{\sigblank}[1]{\underline{\hspace*{#1}}}

% ==================================================================
\begin{document}

%==================== TOP HEADER BLOCK (dynamic) ====================

\noindent
\begin{minipage}[c]{0.20\textwidth}
  \centering
  % replace path with your logo path
  \includegraphics[width=0.80\linewidth]{images/Envimaster.png}%
\end{minipage}%
\hspace{0.8cm}%
\begin{minipage}[c]{0.72\textwidth}
  \centering
  {\bfseries\normalsize\textcolor{emred}{ {{{headerTitle}}} }\par}

  \vspace{0.5em}

  \footnotesize
  \renewcommand{\arraystretch}{1.20}%

  \begin{tabularx}{\linewidth}{@{}lX lX@{}}
    {{#headerRows}}
      \textbf{\textcolor{emred}{ {{{labelLeft}}} }} &
        \filledline{ {{{valueLeft}}} } &
      \textbf{\textcolor{emred}{ {{{labelRight}}} }} &
        \filledline{ {{{valueRight}}} } \\
    {{/headerRows}}
  \end{tabularx}
\end{minipage}

\vspace{1.5em}

%==================== PRODUCTS TITLE BAR ============================

\noindent
\fcolorbox{emred}{emred}{%
  \parbox{\dimexpr\textwidth-2\fboxsep\relax}{%
    \centering
    \bfseries\small\textcolor{white}{PRODUCTS}%
  }%
}

\vspace{0.2em}

%==================== PRODUCTS TABLE (dynamic, page-breaking) ============

\small
\setlength{\tabcolsep}{4pt}
\renewcommand{\arraystretch}{1.4}

% Use longtable for automatic page breaking
\begin{longtable}{|{{{productsColSpecLatex}}}|}
  \hline
  {{{productsHeaderRowLatex}}}
  \endfirsthead

  % Header for subsequent pages
  \hline
  {{{productsHeaderRowLatex}}}
  \endhead

  % Body rows
  {{{productsBodyRowsLatex}}}
\end{longtable}

%==================== SERVICES TITLE BAR ============================

\vspace{0.9em}

\noindent
\fcolorbox{emred}{emred}{%
  \parbox{\dimexpr\textwidth-2\fboxsep\relax}{%
    \centering
    \bfseries\small\textcolor{white}{SERVICES}%
  }%
}

\vspace{0.4em}

%==================== SERVICES BLOCKS (2 ROWS) ======================

{{{servicesTopRowLatex}}}

% bigger gap between service rows for better readability and clarity
\vspace{2.5em}

{{{servicesBottomRowLatex}}}

%==================== REFRESH POWER SCRUB TABLE =====================

\vspace{1.5em}   % extra gap before the heading
{{{refreshSectionLatex}}}

\vspace{1.5em}

%==================== SERVICE NOTES =================================

{{{serviceNotesLatex}}}

%==================== AGREEMENT PARAGRAPH + SIGNATURES ==============

\vspace{0.8em}
\noindent\textcolor{emred}{\rule{\textwidth}{0.4pt}}

\vspace{0.6em}

\small
Enviro-Master of \agreementBlank{ {{{agreementEnviroOf}}} }, and Customer hereby
agree to extend the current term of the current Service Agreement, executed
by Customer on \agreementBlank[1.8cm]{ {{{agreementExecutedOn}}} }, for an
additional \agreementBlank[1.8cm]{ {{{agreementAdditionalMonths}}} } months.
The parties agree that except as amended by this Renewal Addendum, all other
terms and conditions set forth in the Service Agreement shall remain in full
force and effect.

\vspace{1.2em}

\noindent
\begin{minipage}[t]{0.55\textwidth}
  \raggedright
  \textsc{Print}\ \sigblank{7.0cm}\\[-0.2em]
  {\scriptsize Name of Customer}\par

  \vspace{0.8em}

  \textsc{Print}\ \sigblank{7.0cm}\\[-0.2em]
  {\scriptsize Name \& Title of Customer Contact}\par

  \vspace{0.8em}

  By\ \sigblank{4.0cm}\hfill\\[-0.2em]
  {\scriptsize Signature of Authorized Customer Representative}\par
\end{minipage}%
\hfill
\begin{minipage}[t]{0.40\textwidth}
  \raggedright
  Sign\ \sigblank{4.0cm}\hfill Date\ \sigblank{2.0cm}\\[-0.2em]
  {\scriptsize Signature -- Enviro-Master Representative}\par

  \vspace{0.8em}

  Sign\ \sigblank{4.0cm}\hfill Date\ \sigblank{2.0cm}\\[-0.2em]
  {\scriptsize Signature -- Enviro-Master Franchisee}\par
\end{minipage}

\vspace{1.2em}
\noindent\textcolor{emred}{\rule{\textwidth}{0.4pt}}

\end{document}
